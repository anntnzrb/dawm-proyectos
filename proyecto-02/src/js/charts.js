const chartA = async () => {
  const ctx = document.getElementById("chart-bars").getContext("2d");

  const repos = ["anntnzrb",
                 "estructuras-datos",
                 "dawm",
                 "dawm-proyectos",
                 "guia07",
                 "guia08"
                ];

  let repos_commits = [];
  for (const f of repos) {
    const repo_commits = await fetchAPI('json', `${BASE_API}/repos/anntnzrb/${f}/commits?per_page=80`);
    repos_commits.push(Array.from(repo_commits).length);
  }

  new Chart(ctx, {
    type: "bar",
    data: {
      labels: repos,
      datasets: [{
        tension: 0.4,
        borderWidth: 0,
        borderRadius: 4,
        borderSkipped: false,
        backgroundColor: "rgba(255, 255, 255, .8)",
        data: repos_commits,
        maxBarThickness: 18
            },],
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false,
                }
            },
            interaction: {
                intersect: false,
                mode: 'index',
            },
            scales: {
                y: {
                    grid: {
                        drawBorder: false,
                        display: true,
                        drawOnChartArea: true,
                        drawTicks: false,
                        borderDash: [5, 5],
                        color: 'rgba(255, 255, 255, .2)'
                    },
                    ticks: {
                        suggestedMin: 0,
                        suggestedMax: 500,
                        beginAtZero: true,
                        padding: 10,
                        font: {
                            size: 14,
                            weight: 300,
                            family: "Roboto",
                            style: 'normal',
                            lineHeight: 2
                        },
                        color: "#fff"
                    },
                },
                x: {
                    grid: {
                        drawBorder: false,
                        display: true,
                        drawOnChartArea: true,
                        drawTicks: false,
                        borderDash: [5, 5],
                        color: 'rgba(255, 255, 255, .2)'
                    },
                    ticks: {
                        display: true,
                        color: '#f8f9fa',
                        padding: 10,
                        font: {
                            size: 14,
                            weight: 300,
                            family: "Roboto",
                            style: 'normal',
                            lineHeight: 2
                        },
                    }
                },
            },
        },
  });
};

const chartB = async () => {
  const ctx = document.getElementById("chart-line").getContext("2d");

  const repo = "anntnzrb/dawm-proyectos";
  const repo_langs = await fetchAPI('json', `${BASE_API}/repos/${repo}/languages`);

  let langs = new Array();
  let lang_count = new Array();
  Object.entries(repo_langs).forEach(e => {
    const [k, v] = e;
    langs.push(k);
    lang_count.push(v);
  });

  new Chart(ctx, {
    type: "bar",
    data: {
      labels: langs,
      datasets: [{
        tension: 0.4,
        borderWidth: 0,
        borderRadius: 4,
        borderSkipped: false,
        backgroundColor: "rgba(255, 255, 255, .8)",
        data: lang_count,
        maxBarThickness: 18
      },],
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          display: false,
        }
      },
      interaction: {
        intersect: false,
        mode: 'index',
      },
      scales: {
        y: {
          grid: {
            drawBorder: false,
            display: true,
            drawOnChartArea: true,
            drawTicks: false,
            borderDash: [5, 5],
            color: 'rgba(255, 255, 255, .2)'
          },
          ticks: {
            suggestedMin: 0,
            suggestedMax: 500,
            beginAtZero: true,
            padding: 10,
            font: {
              size: 14,
              weight: 300,
              family: "Roboto",
              style: 'normal',
              lineHeight: 2
            },
            color: "#fff"
          },
        },
        x: {
          grid: {
            drawBorder: false,
            display: true,
            drawOnChartArea: true,
            drawTicks: false,
            borderDash: [5, 5],
            color: 'rgba(255, 255, 255, .2)'
          },
          ticks: {
            display: true,
            color: '#f8f9fa',
            padding: 10,
            font: {
              size: 14,
              weight: 300,
              family: "Roboto",
              style: 'normal',
              lineHeight: 2
            },
          }
        },
      },
    },
  });
};

(async () => {
  chartA();
  chartB();
})();
